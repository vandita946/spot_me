<%# <% if policy(Goal).show? %>
  <%# <%= link_to "Independent Goal", new_goal_path %>
<%# <% end %>
<div class="container d-flex flex-column">
  <div class="d-flex justify-content-center">
    <h2 class="my-0"><i id="title-icon" class="fa fa-<%= @goal.icon %> mb-3"></i></h2>
    <h2 class="my-0 ml-3"><%= @goal.title %></h2>
  </div>

  <div class="container p-0">
    <!--Navigation links with a Smooth Scroll effect-->
    <ul class="smooth-scroll list-unstyled list-inline d-flex justify-content-around mb-1">
      <li class="list-inline-item"><h5><a href="#test1" class="text-decoration-none">Chatbox</a></h5></li>
      <li class="list-inline-item"><h5><a href="#test2" class="text-decoration-none">Milestones</a></h5></li>
    </ul>
  </div>

  <div class="container mb-1"><h6 class="text-muted" style="text-decoration: underline;">Description: <br></h6><h6>  <%= @goal.description %> </h6></div>
  <div class="container d-flex justify-content-center">
    <p class="my-0 mr-3"> <%= @goal.status %> </p>
    <a id="edit-icon" href="blank" data-toggle="modal" data-target="#goal-edit" >
      <i class="fas fa-edit"></i>
    </a> 
  </div>
  <div class="px-3">
    <div class="progress my-2">
      <div class="progress-bar progress-bar progress-bar-striped" role="progressbar" aria-valuenow=<%=@goal.progress%> aria-valuemin="0" aria-valuemax="100" style="width:<%=@goal.progress%>%"></div>
    </div>
  </div>
</div>

  <%# Modal for editing the goal specifically %>
  <%= render partial: "shared/goal_edit", locals: {goal: @goal} %> 


  <div class="container d-flex flex-column" id="text2"><%= render 'shared/goalcards' %></div>
  


</br>



<%# Chatroom for the goal %>
<div class="container mb-3" id="test1">
  <div class="container d-flex"><h2 class="font-weight-bold"> Chat </h2></div>
  <div class="overflow-auto chatroom-size rounded-lg" id="messages" data-chatroom-id="<%= @chatroom.id %>">
    <% @chatroom.messages.each do |message| %>
    <div class="notification">
    <%# INSERT AVATAR HERE %>
    <% if message.user.avatar_thumbnail %>
    <%= image_tag message.user.avatar_thumbnail, class: "avatar-large" %>
    <% else %>
    <%= image_tag "Portrait_Placeholder.jpg", class: "avatar-large" %>
    <% end %>
    <div class="notification-content">
      <div class="message-container" id="message-<%= message.id %>">
        <i class="author">
          <span><%= message.user.firstname %></span>
          <small><%= message.created_at.strftime("%a %b %e at %l:%M%p") %></small>
        </i>
        <p><%= message.content %></p>
      </div>
    </div>
    </div>
    <% end %>
    <% if @chatroom.messages.size < 5 %>
    <span class="d-flex align-items-end justify-content-center bg-white">No more messages</span>
    <% end %>
  </div>
  <%= simple_form_for [ @chatroom, @message ], remote: true do |f| %>
    <%= f.input :content, label: false, placeholder: "What's on your mind?" %>
    <%= f.button :submit, "Send message", class: "btn btn-primary" %>
  <% end %>

</div>



<%# LOGIC GATES HERE %>
<% if @user.nil? %>


<!-- Development use only: Button trigger modal -->
<%# <button type="button" class="btn btn-primary my-3" data-toggle="modal" data-target="#staticBackdrop">
  Launch static backdrop modal
</button> %>

  <!-- Modal -->
  <div class="modal fade notauser" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header d-flex justify-content-center">
          <h5 class="modal-title" id="staticBackdropLabel">Register as a user to view the goal</h5>
          <%# <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button> %>
        </div>
        <div class="modal-body">
          To view the goal, please register or login as a user. <br> <br>
          To be a buddy, please register or login as a user. <br> <br>
          User, user, user, user, user, user, <br>
          user, user, user, user, user, user, <br>
          user, user, user, user, user, user, <br>
          user, user, user, joel, user, user, <br>
          user, user, user, user, user, user, <br>
          user, user, user, user, user, user, <br>
          user, user, user, user, user, user, <br>
        </div>
        <div class="modal-footer d-flex justify-content-center">
          <%= link_to :back do %>
            <button type="button" class="btn btn-link">Go back</button>
          <% end %>
          <%# <%= link_to "< Go Back", :back %>

          <%= link_to new_user_session_path do %>
            <button type="button" class="btn btn-secondary mx-3">Sign In</button>
          <% end %>

          <%= link_to new_user_registration_path(goal: @goal) do %>
            <button type="button" class="btn btn-primary">Register</button>
          <% end %>

          <%# <button type="button" class="btn btn-secondary" data-dismiss="modal">Home</button> %>
          <%# <button type="button" class="btn btn-primary">Understood</button> %>
        </div>
      </div>
    </div>
  </div>

<% end %>